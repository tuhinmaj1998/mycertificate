<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Multi Step Form</title>
      <!-- Bootstrap CSS -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
      <!-- Google Font -->
      <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="/static/css/organiser-template.css">
      <script src="/static/js/organiser-template.js"></script>
   </head>
   <body id="body1">
   <div id = "loader1" style="display:block;"></div>
      <div class="container">
         <div class="progress">
            <div class="progress-bar progress-bar-striped bg-success"
               role="progressbar"
               style="width: 0%"
               aria-valuenow="0" aria-valuemin="0"
               aria-valuemax="100">
            </div>
         </div>

         <div class="step active">
            <p class="text-center mb-4 step-title">STEP 1: Select Template</p>
            <div class="mb-3">
               <p id="allTemplateData" style="display:block;"></p>
                <div class="row">

                    <div class="col-8">
                        <select class="form-select" aria-label="Template-List" id="Template-List" onInput='selectRegisteredTemplate()'>
                            <option selected>Open this select menu</option>
                        </select>
                    </div>

                    <div class="col-4">
                        <button type="button" class="btn btn-warning" onclick="getRegisteredTemplate(1);">Refresh</button>
                    </div>
                </div>

               <div class="container mb-3 columns" style="margin-top:30px; display:none;" id = 'docx-cols-div'>
                  <span>Columns:</span>
                  <div id="docx-cols" style="display:none;">
                     <span class="badge bg-dark">Primary</span>
                  </div>
               </div>
            </div>

            <div class="d-flex align-items-center justify-content-center">

<!--                <img id="loader_regtemp" src="/static/assets/gif/loader1.gif" alt="Searching Template..." style="display:block;">-->
            </div>
            <p class="text-center mb-4" id="Searching-Template">Searching Template...</p>
         </div>

         <div class="step">
            <p class="text-center mb-4 step-title">Step 2: Add Google Sheet</p>
            <div class="mb-3 col-md-11">



                <label for="selectGsheet">Select Google Sheets File:</label>
                <select class="form-select" id="selectGsheet" onchange="fetchSheetNames()">
                    <option value="">Loading...</option>
                </select>
                <br><br>
                <label for="selectSheet">Select Sheet:</label>
                <select class="form-select" id="selectSheet" onchange="verifyGsheet_automatic();">
                    <option value="">Select a sheet...</option>
                </select>
                <br>






               <label>Google Sheet Link</label>
               <input type="text" placeholder="Enter the Google Sheet" oninput="this.className = ''" name="spreadsheet_url" id="spreadsheet_url">
            </div>

            <div class="mb-3 col-md-5" style="display:inline-block; margin-right:10px;">
               <label>Work Sheet</label>
               <input type="text" placeholder="Enter the Work Sheet Name" oninput="this.className = ''" name="sheetname" id="sheetname">
            </div>

             <div class="mb-3 col-md-6" style="display:inline-block">
               <label>Authentication Key</label>
               <input type="password" placeholder="Enter the Authentication Key" oninput="this.className = ''" name="password" id="password">
            </div>
            <div class="d-flex align-items-center justify-content-center">
            <button id="verify-gsheet" type="button" class="btn btn-warning" onclick="verifyGsheet()">Verify</button>
            </div>

<!--            <div class="d-flex align-items-center justify-content-center">-->
<!--                <img id="loader1" src="/static/assets/gif/loader1.gif" alt="Computer man" style="width:48px;height:48px; margin: 10px 0 10px 0; display:none;">-->
<!--            </div>-->

             <div id="myProgress">
                <div id="myBar"></div>
             </div>

            <div class="container mt-3" id="sample-gsheet-result" style="display:none;">
              <h2>Result</h2>
              <p>Here are the sample response of your sheet:</p>
              <table id="verifyGsheetTable" class="table table-dark w-auto breaked">
                    <!--data will be entered via js-->
              </table>
            </div>
         </div>



         <div class="step">
            <p class="text-center mb-4 step-title">Step 3: Map Columns</p>
             <div class="container mt-3" id="mapping-table">
              <h4>Column Mapping:</h4>
              <p>Map the template column with Gsheet Columns</p>
              <table id="mappingTable" class="table w-auto breaked" onchange="populateSampleInputTable();">
                  <thead>
                    <tr>
                        <th>Template Column</th>
                        <th>Gsheet Column</th>
                        <th>Hardcoded Value (If Applicable)</th>
                    </tr>
                </thead>
                <tbody id="columnmapping-tbody">
                    <!-- Rows will be dynamically added here -->
                </tbody>
              </table>
             </div>
             <div class="container mt-3">
                 <div class="row">
                     <div class="col-5 mx-auto overflow-auto">
                         <h4>Sample Testing:</h4>
                         <p>Preview with sample Input:</p>
                         <div>
                             <table id="sampleInputTable" class="table w-auto breaked" onchange="collectSampleData()">
                                <thead>
                                    <tr>
                                        <th>Template Column</th>
                                        <th>Sample Value</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody">
                                    <!-- Rows will be dynamically added here -->
                                </tbody>
                            </table>
                         </div>
                     </div>
                     <div class="col-7 mx-auto">
                         <div class="d-flex align-items-center justify-content-evenly">
                             <button class="btn btn-warning" onclick="generateCertGdrive(1)">Generate</button>
                         </div>
                         <div class="mt-3 overflow-hidden">
                             <iframe id="embedded-sample-cert" src="/static/output/sample/output_TUHIN M.pdf" width="100%" height="290px;" style="display:none;"></iframe>

                         </div>
                     </div>
                 </div>

             </div>

         </div>
         <div class="form-footer d-flex">
            <button type="button" id="prevBtn" style="display:none;" onclick="nextPrev(-1)">Previous
            </button>
            <button type="button" id="nextBtn"
               onclick="nextPrev(1)">Next
            </button>
         </div>
      </div>
   </body>
</html>